<article>
  <hgroup>
  	<h1>Benchmark.js test page</h1>
  	<h2>JavaScript performance comparison</h2>
  </hgroup>
  
  <section id="prep-code">
  	<h2>Preparation code</h2>
  	<pre><code></code></pre>
  </section>
  
  <section>
  	<h2>Preparation code output</h2>
  	<div class="user-output">
  	</div>
  </section>

	<section id="runner">
		<h2>Test runner</h2>
		<p id="firebug">
			<strong>Warning! For accurate results, please disable Firebug before running the tests. <a href="http://jsperf.com/faq#firebug-warning">(Why?)</a></strong>
		</p>
		<p id="java">
			<strong>Java applet disabled.</strong>
		</p>
		<p id="status">
			<noscript>
				<strong>To run the tests, please <a href="http://enable-javascript.com/">enable JavaScript</a> and reload the page.</strong>
			</noscript>
		</p>
		<div id="controls">
			<button id="run" type="button"></button>
		</div>
		<table id="test-table">
			<caption>Testing in <span id="user-agent"></span></caption>
			<thead>
			<tr>
				<th colspan="2">Test</th>
				<th title="Operations per second (higher is better)">Ops/sec</th>
			</tr>
			</thead>
			<tbody>
			<tr>
				<th scope="row" id="title-1">
					<div>Normal</div>
				</th>
				<td class="code">
					<pre><code>x.<span class="me1">sort</span><span class="br0">&#40;</span><span
						class="kw2">function</span><span class="br0">&#40;</span>a<span
						class="sy0">,</span> b<span class="br0">&#41;</span> <span
						class="br0">&#123;</span><br>&nbsp; <span class="kw1">return</span> a <span
						class="sy0">-</span> b<span class="sy0">;</span><br><span
						class="br0">&#125;</span><span class="br0">&#41;</span><span
						class="sy0">;</span></code></pre>
				</td>
				<td id="results-1" class="results"></td>
			</tr>
			<tr>
				<th scope="row" id="title-2">
					<div>Exit Early</div>
				</th>
				<td class="code">
					<pre><code>x.<span class="me1">sort</span><span class="br0">&#40;</span><span
						class="kw2">function</span><span class="br0">&#40;</span>a<span
						class="sy0">,</span> b<span class="br0">&#41;</span> <span
						class="br0">&#123;</span><br>&nbsp; <span class="kw1">return</span> a <span
						class="sy0">-</span> b<span class="sy0">;</span><br><span
						class="br0">&#125;</span><span class="br0">&#41;</span><span
						class="sy0">;</span><br><span class="kw1">return</span><span
						class="sy0">;</span></code></pre>
				</td>
				<td id="results-2" class="results"></td>
			</tr>
			<tr>
				<th scope="row" id="title-3">
					<div>Async</div>
				</th>
				<td class="code">
					<pre><code><strong class="co1">// async test</strong><br>setTimeout<span
						class="br0">&#40;</span><span class="kw2">function</span><span
						class="br0">&#40;</span><span class="br0">&#41;</span> <span
						class="br0">&#123;</span><br>&nbsp; deferred.<span
						class="me1">resolve</span><span class="br0">&#40;</span><span
						class="br0">&#41;</span><span class="sy0">;</span><br><span
						class="br0">&#125;</span><span class="sy0">,</span> <span
						class="nu0">10</span><span class="br0">&#41;</span><span
						class="sy0">;</span></code></pre>
				</td>
				<td id="results-3" class="results"></td>
			</tr>
			<tr>
				<th scope="row" id="title-4">
					<div>Error</div>
				</th>
				<td class="code">
					<pre><code>x.<span class="me1">foo</span><span class="br0">&#40;</span><span
						class="br0">&#41;</span><span class="sy0">;</span> <span
						class="co1">// unknown method</span></code></pre>
				</td>
				<td id="results-4" class="results"></td>
			</tr>
			<tr>
				<th scope="row" id="title-5">
					<div>Comments</div>
				</th>
				<td class="code">
					<pre><code><span class="co1">// comments at start</span><br>x.<span
						class="me1">reverse</span><span class="br0">&#40;</span><span
						class="br0">&#41;</span>.<span class="me1">sort</span><span
						class="br0">&#40;</span><span class="kw2">function</span><span
						class="br0">&#40;</span>a<span class="sy0">,</span> b<span
						class="br0">&#41;</span> <span class="br0">&#123;</span><br>&nbsp; <span
						class="kw1">return</span> a <span class="sy0">-</span> b<span
						class="sy0">;</span><br><span class="br0">&#125;</span><span
						class="br0">&#41;</span><span class="sy0">;</span><br><span
						class="co1">// comments at end</span></code></pre>
				</td>
				<td id="results-5" class="results"></td>
			</tr>
			</tbody>
		</table>
	</section>

	<section>
		<h2 id="results">Compare results of other browsers</h2>
		<div id="bs-results"></div>
	</section>

</article>


<footer>

</footer>

<%= javascript_include_tag "benchmarking/bestiejs" %>

<script>
	var arr = [1, 5, 4, 2, 3];

	function init() {
		window.console && console.log('init called');
	}
</script>
<script>
	ui.browserscope.key = 'agt1YS1wcm9maWxlcnINCxIEVGVzdBjR6NELDA';
	ui.browserscope.selector = '#bs-results';

	ui.add('Normal', '\
		x.sort(function(a, b) {\n\
			return a - b;\n\
		});'
	)
	.add('Exit Early', '\
		x.sort(function(a, b) {\n\
			return a - b;\n\
		});\n\
		return;'
	)
	.add('Async', {
		'defer': true,
		'fn': '\
			setTimeout(function() {\n\
				deferred.resolve();\n\
			}, 10);'
	})
	.add('Error', '\
		x.foo(); // unknown method'
	)
	.add('Comments', '\
		// comments at start\n\
		x.reverse().sort(function(a, b) {\n\
			return a - b;\n\
		});\n\
		// comments at end'
	);

	Benchmark.prototype.setup = '\
		window.foo = 42;\n\
		var x = arr;';

	Benchmark.prototype.teardown = '\
		window.foo = 24;';
</script>
